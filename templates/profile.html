<!DOCTYPE html>
<html>
<head>
    <title>Spotify Profile</title>
    <style>
      body {
        font-family: sans-serif;
        margin: 2em;
      }
      button {
        padding: 0.5em 1em;
        font-size: 1em;
        background-color: #1DB954;
        color: white;
        border: none;
        border-radius: 5px;
      }
    </style>
</head>
<body>
    <h1>üéß Spotify Profile</h1>
    <p><strong>Display Name:</strong> {{ user.display_name }}</p>
    <p><strong>Email:</strong> {{ user.email }}</p>
    <p><a href="{{ url_for('logout') }}"><button>Sign Out</button></a></p>

    <hr>
    <h2>Your All-Time Top Artists</h2>
    <div id="artist-list">Loading...</div>

    <script>
      fetch("{{ url_for('top_artists') }}")
        .then(response => response.json())
        .then(data => {
          const container = document.getElementById('artist-list');
          if (data.error) {
            container.textContent = "‚ö†Ô∏è Could not load top artists.";
            return;
          }

          const ul = document.createElement("ul");
          data.artists.forEach(a => {
            const li = document.createElement("li");
            const link = document.createElement("a");
            link.href = a.url;
            link.textContent = a.name;
            link.target = "_blank";
            li.appendChild(link);
            ul.appendChild(li);
          });
          container.innerHTML = "";
          container.appendChild(ul);
        })
        .catch(err => {
          console.error(err);
          document.getElementById('artist-list').textContent = "‚ö†Ô∏è Error loading artist data.";
        });
    </script>
</body>
</html>
